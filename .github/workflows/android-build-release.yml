- name: Fix old Gradle syntax + migrate test deps
        working-directory: GroceryMobileApp/app
        run: |
          # Tukar semua varian compile lama → API baru (tangkap yang ada/tiada ruang & ada/tiada bracket)
          sed -E -i 's/[[:<:]]compile[[:>:]]/implementation/g' build.gradle
          sed -E -i 's/[[:<:]]testCompile[[:>:]]/testImplementation/g' build.gradle
          sed -E -i 's/[[:<:]]androidTestCompile[[:>:]]/androidTestImplementation/g' build.gradle

          # Migrasi dependency test lama (Support) → AndroidX
          sed -E -i "s#com\.android\.support\.test:runner:[^\"']+#androidx.test:runner:1.5.2#g" build.gradle
          sed -E -i "s#com\.android\.support\.test:rules:[^\"']+#androidx.test:rules:1.5.0#g" build.gradle
          sed -E -i "s#com\.android\.support\.test\.espresso:espresso-core:[^\"']+#androidx.test.espresso:espresso-core:3.5.1#g" build.gradle

          # Pastikan compile/target SDK moden
          sed -E -i 's/compileSdkVersion *[0-9]+/compileSdkVersion 34/g' build.gradle
          sed -E -i 's/targetSdkVersion *[0-9]+/targetSdkVersion 34/g' build.gradle
