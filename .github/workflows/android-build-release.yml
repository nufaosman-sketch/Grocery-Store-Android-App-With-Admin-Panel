- name: Force AGP 7.4.2 + remove jcenter
        working-directory: GroceryMobileApp
        run: |
          # Tukar apa-apa 'com.android.tools.build:gradle:*' → 7.4.2 di semua build.gradle
          grep -Rl "com.android.tools.build:gradle:" . | xargs -r sed -i -E "s#com\.android\.tools\.build:gradle:[0-9.]+#com.android.tools.build:gradle:7.4.2#g"

          # Tukar jcenter() → mavenCentral() di semua gradle file
          grep -Rl "jcenter\\(\\)" . | xargs -r sed -i "s/jcenter()/mavenCentral()/g"

          # Pastikan project-level build.gradle betul (overwrite untuk selamat)
          cat > build.gradle <<'GRADLE'
          buildscript {
            repositories { google(); mavenCentral() }
            dependencies {
              classpath 'com.android.tools.build:gradle:7.4.2'
              classpath 'com.google.gms:google-services:4.3.15'
            }
          }
          allprojects { repositories { google(); mavenCentral() } }
          task clean(type: Delete) { delete rootProject.buildDir }
          GRADLE
